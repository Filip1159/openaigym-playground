C:\Users\fwisn\miniconda3\envs\openaigym-playground\python.exe C:\Users\fwisn\PycharmProjects\openaigym-playground\r06\02_dqn_pong.py
A.L.E: Arcade Learning Environment (version 0.11.1+2750686)
[Powered by Stella]
Game console created:
  ROM file:  C:\Users\fwisn\miniconda3\envs\openaigym-playground\Lib\site-packages\ale_py\roms\pong.bin
  Cart Name: Video Olympics (1978) (Atari)
  Cart MD5:  60e0ea3cbe0913d39803477945e9e5ec
  Display Format:  AUTO-DETECT ==> NTSC
  ROM Size:        2048
  Bankswitch Type: AUTO-DETECT ==> 2K

Running ROM file...
Random seed is 1750968938
A.L.E: Arcade Learning Environment (version 0.11.1+2750686)
[Powered by Stella]
DQN(
  (conv): Sequential(
    (0): Conv2d(4, 32, kernel_size=(8, 8), stride=(4, 4))
    (1): ReLU()
    (2): Conv2d(32, 64, kernel_size=(4, 4), stride=(2, 2))
    (3): ReLU()
    (4): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1))
    (5): ReLU()
  )
  (fc): Sequential(
    (0): Linear(in_features=3136, out_features=512, bias=True)
    (1): ReLU()
    (2): Linear(in_features=512, out_features=6, bias=True)
  )
)
927: gry - 1, nagroda -21.000, eps 0.99, 1449.02 fps
1910: gry - 2, nagroda -21.000, eps 0.99, 1767.93 fps
2810: gry - 3, nagroda -20.667, eps 0.98, 1817.53 fps
Nagroda uleg�a zmianie: -21.000 -> -20.667
4077: gry - 4, nagroda -19.750, eps 0.97, 1761.88 fps
Nagroda uleg�a zmianie: -20.667 -> -19.750
4899: gry - 5, nagroda -20.000, eps 0.97, 1716.80 fps
5982: gry - 6, nagroda -19.833, eps 0.96, 1779.52 fps
7019: gry - 7, nagroda -19.857, eps 0.95, 1758.48 fps
7869: gry - 8, nagroda -20.000, eps 0.95, 1743.51 fps
8763: gry - 9, nagroda -20.000, eps 0.94, 1734.57 fps
9615: gry - 10, nagroda -20.100, eps 0.94, 1728.06 fps
10377: gry - 11, nagroda -20.182, eps 0.93, 308.38 fps
11257: gry - 12, nagroda -20.250, eps 0.92, 181.41 fps
12337: gry - 13, nagroda -20.231, eps 0.92, 176.42 fps
13308: gry - 14, nagroda -20.214, eps 0.91, 180.21 fps
14274: gry - 15, nagroda -20.200, eps 0.90, 179.54 fps
15036: gry - 16, nagroda -20.250, eps 0.90, 173.46 fps
15981: gry - 17, nagroda -20.235, eps 0.89, 179.63 fps
16800: gry - 18, nagroda -20.278, eps 0.89, 176.86 fps
17816: gry - 19, nagroda -20.211, eps 0.88, 175.47 fps
18640: gry - 20, nagroda -20.250, eps 0.88, 180.34 fps
19552: gry - 21, nagroda -20.286, eps 0.87, 185.63 fps
20423: gry - 22, nagroda -20.318, eps 0.86, 191.23 fps
21308: gry - 23, nagroda -20.348, eps 0.86, 191.64 fps
22248: gry - 24, nagroda -20.375, eps 0.85, 190.50 fps
23029: gry - 25, nagroda -20.400, eps 0.85, 192.00 fps
23875: gry - 26, nagroda -20.423, eps 0.84, 189.32 fps
24665: gry - 27, nagroda -20.444, eps 0.84, 188.70 fps
25667: gry - 28, nagroda -20.464, eps 0.83, 191.72 fps
26775: gry - 29, nagroda -20.448, eps 0.82, 190.63 fps
27615: gry - 30, nagroda -20.433, eps 0.82, 192.80 fps
28499: gry - 31, nagroda -20.452, eps 0.81, 190.43 fps
29339: gry - 32, nagroda -20.438, eps 0.80, 191.76 fps
30179: gry - 33, nagroda -20.424, eps 0.80, 191.35 fps
31070: gry - 34, nagroda -20.412, eps 0.79, 174.64 fps
32186: gry - 35, nagroda -20.371, eps 0.79, 176.04 fps
33026: gry - 36, nagroda -20.361, eps 0.78, 175.03 fps
34056: gry - 37, nagroda -20.351, eps 0.77, 176.55 fps
34906: gry - 38, nagroda -20.368, eps 0.77, 176.59 fps
35784: gry - 39, nagroda -20.385, eps 0.76, 174.95 fps
36684: gry - 40, nagroda -20.375, eps 0.76, 187.27 fps
37465: gry - 41, nagroda -20.390, eps 0.75, 186.63 fps
38246: gry - 42, nagroda -20.405, eps 0.75, 186.31 fps
39220: gry - 43, nagroda -20.372, eps 0.74, 187.58 fps
40145: gry - 44, nagroda -20.364, eps 0.73, 186.43 fps
41454: gry - 45, nagroda -20.289, eps 0.72, 186.17 fps
42383: gry - 46, nagroda -20.283, eps 0.72, 185.77 fps
43164: gry - 47, nagroda -20.298, eps 0.71, 185.34 fps
44064: gry - 48, nagroda -20.312, eps 0.71, 187.31 fps
44914: gry - 49, nagroda -20.327, eps 0.70, 185.81 fps
45966: gry - 50, nagroda -20.300, eps 0.69, 186.54 fps
46945: gry - 51, nagroda -20.294, eps 0.69, 186.43 fps
47875: gry - 52, nagroda -20.288, eps 0.68, 188.45 fps
48656: gry - 53, nagroda -20.302, eps 0.68, 188.44 fps
49598: gry - 54, nagroda -20.315, eps 0.67, 187.98 fps
50600: gry - 55, nagroda -20.309, eps 0.66, 188.08 fps
51501: gry - 56, nagroda -20.321, eps 0.66, 188.07 fps
52371: gry - 57, nagroda -20.333, eps 0.65, 187.88 fps
53338: gry - 58, nagroda -20.345, eps 0.64, 169.47 fps
54502: gry - 59, nagroda -20.339, eps 0.64, 165.88 fps
55294: gry - 60, nagroda -20.350, eps 0.63, 174.32 fps
56223: gry - 61, nagroda -20.361, eps 0.63, 162.35 fps
57572: gry - 62, nagroda -20.323, eps 0.62, 172.91 fps
58577: gry - 63, nagroda -20.317, eps 0.61, 182.16 fps
59680: gry - 64, nagroda -20.281, eps 0.60, 175.38 fps
60908: gry - 65, nagroda -20.231, eps 0.59, 175.90 fps
62211: gry - 66, nagroda -20.182, eps 0.59, 182.09 fps
63183: gry - 67, nagroda -20.179, eps 0.58, 176.35 fps
64353: gry - 68, nagroda -20.132, eps 0.57, 172.85 fps
65317: gry - 69, nagroda -20.145, eps 0.56, 167.44 fps
66388: gry - 70, nagroda -20.143, eps 0.56, 170.77 fps
67315: gry - 71, nagroda -20.155, eps 0.55, 163.68 fps
68580: gry - 72, nagroda -20.125, eps 0.54, 177.08 fps
69897: gry - 73, nagroda -20.082, eps 0.53, 180.16 fps
71062: gry - 74, nagroda -20.081, eps 0.53, 184.31 fps
72246: gry - 75, nagroda -20.067, eps 0.52, 180.38 fps
73405: gry - 76, nagroda -20.026, eps 0.51, 180.55 fps
74625: gry - 77, nagroda -20.000, eps 0.50, 171.56 fps
75817: gry - 78, nagroda -19.987, eps 0.49, 170.87 fps
77087: gry - 79, nagroda -19.962, eps 0.49, 175.91 fps
78101: gry - 80, nagroda -19.975, eps 0.48, 171.55 fps
79541: gry - 81, nagroda -19.963, eps 0.47, 169.66 fps
80799: gry - 82, nagroda -19.963, eps 0.46, 166.05 fps
82106: gry - 83, nagroda -19.952, eps 0.45, 164.95 fps
83780: gry - 84, nagroda -19.893, eps 0.44, 170.42 fps
84889: gry - 85, nagroda -19.906, eps 0.43, 178.95 fps
85971: gry - 86, nagroda -19.907, eps 0.43, 180.25 fps
87323: gry - 87, nagroda -19.908, eps 0.42, 179.29 fps
89037: gry - 88, nagroda -19.864, eps 0.41, 178.84 fps
90445: gry - 89, nagroda -19.843, eps 0.40, 177.47 fps
92126: gry - 90, nagroda -19.811, eps 0.39, 176.60 fps
93728: gry - 91, nagroda -19.780, eps 0.38, 179.19 fps
95231: gry - 92, nagroda -19.783, eps 0.37, 163.83 fps
96539: gry - 93, nagroda -19.774, eps 0.36, 157.71 fps
98720: gry - 94, nagroda -19.681, eps 0.34, 167.64 fps
Nagroda uleg�a zmianie: -19.750 -> -19.681
100153: gry - 95, nagroda -19.663, eps 0.33, 169.64 fps
Nagroda uleg�a zmianie: -19.681 -> -19.663
101565: gry - 96, nagroda -19.656, eps 0.32, 176.81 fps
Nagroda uleg�a zmianie: -19.663 -> -19.656
103164: gry - 97, nagroda -19.639, eps 0.31, 176.44 fps
Nagroda uleg�a zmianie: -19.656 -> -19.639
104725: gry - 98, nagroda -19.622, eps 0.30, 175.23 fps
Nagroda uleg�a zmianie: -19.639 -> -19.622
106144: gry - 99, nagroda -19.626, eps 0.29, 174.70 fps
108423: gry - 100, nagroda -19.550, eps 0.28, 174.91 fps
Nagroda uleg�a zmianie: -19.622 -> -19.550
110122: gry - 101, nagroda -19.520, eps 0.27, 176.74 fps
Nagroda uleg�a zmianie: -19.550 -> -19.520
111952: gry - 102, nagroda -19.470, eps 0.25, 177.68 fps
Nagroda uleg�a zmianie: -19.520 -> -19.470
113673: gry - 103, nagroda -19.430, eps 0.24, 178.02 fps
Nagroda uleg�a zmianie: -19.470 -> -19.430
115377: gry - 104, nagroda -19.430, eps 0.23, 171.58 fps
117028: gry - 105, nagroda -19.390, eps 0.22, 155.98 fps
Nagroda uleg�a zmianie: -19.430 -> -19.390
118552: gry - 106, nagroda -19.400, eps 0.21, 153.78 fps
gather(): Expected dtype int64 for index
states_v
tensor([[[[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]]],


        [[[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]]],


        [[[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3490, 0.4196, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.4275, 0.8941, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.7059, 0.8784, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]]],


        ...,


        [[[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]]],


        [[[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]]],


        [[[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]],

         [[0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          ...,
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.3412, 0.3412, 0.3412,  ..., 0.3412, 0.3412, 0.3412],
          [0.5608, 0.5608, 0.5608,  ..., 0.5608, 0.5608, 0.5608]]]],
       device='cuda:0')
states_v.shape
torch.Size([32, 4, 84, 84])
actions_v
tensor([4, 5, 1, 4, 2, 2, 2, 2, 4, 4, 0, 1, 0, 5, 2, 4, 0, 3, 3, 2, 4, 4, 3, 4,
        4, 2, 4, 4, 4, 2, 5, 1], device='cuda:0', dtype=torch.int32)
actions_v.shape
torch.Size([32])
net(states_v)
tensor([[ 0.7716,  0.7707,  0.8311,  0.7506,  0.8203,  0.7699],
        [ 1.4419,  1.3129,  1.2410,  1.4346,  1.3523,  1.5474],
        [ 0.7591,  0.7153,  0.7880,  0.7393,  0.8037,  0.7582],
        [ 0.6481,  0.5610,  0.6281,  0.4585,  0.6276,  0.4268],
        [ 0.6782,  0.7137,  0.7498,  0.7472,  0.7298,  0.7155],
        [ 0.8552,  0.8633,  0.8775,  0.8264,  0.8847,  0.8539],
        [ 0.7970,  0.7972,  0.8042,  0.7892,  0.8438,  0.7639],
        [ 0.9090,  0.8871,  0.9252,  0.8540,  0.9098,  0.9115],
        [ 0.9463,  0.8806,  0.9449,  0.9042,  0.9673,  0.8337],
        [ 0.9860,  0.9906,  0.9379,  0.9791,  0.9406,  1.0371],
        [-0.0849, -0.0904, -0.0576,  0.0219, -0.0830, -0.0864],
        [ 0.8760,  0.9824,  0.9207,  0.9318,  0.8636,  0.9743],
        [ 0.9517,  0.8612,  0.9313,  0.8676,  0.8875,  0.9625],
        [ 1.1039,  1.0696,  1.0792,  1.1022,  1.0587,  1.0891],
        [-0.2858, -0.4282, -0.1134, -0.3535, -0.2851, -0.3738],
        [ 1.1234,  1.1101,  1.1389,  1.1147,  1.2366,  1.0425],
        [ 0.7806,  0.7656,  0.7917,  0.8089,  0.8048,  0.7789],
        [ 0.8381,  0.8106,  0.8903,  0.9286,  0.8458,  0.8720],
        [ 1.4360,  1.4322,  1.4452,  1.4725,  1.3617,  1.4388],
        [-0.3004, -0.3960, -0.2357, -0.3245, -0.3943, -0.3042],
        [ 1.1053,  0.9680,  1.0306,  1.1035,  1.2262,  1.0754],
        [ 1.2973,  1.2859,  1.4138,  1.3606,  1.4334,  1.4338],
        [ 0.9046,  0.8692,  0.8352,  0.8132,  0.8700,  0.8089],
        [ 1.0592,  0.9371,  1.0033,  0.8712,  1.2056,  1.0447],
        [ 0.6567,  0.7293,  0.6762,  0.7216,  0.7559,  0.6783],
        [ 0.4162,  0.2947,  0.2999,  0.5312,  0.4513,  0.5662],
        [ 0.3438,  0.2670,  0.3713,  0.1838,  0.3593,  0.2340],
        [-0.5522, -0.6639, -0.3211, -0.5948, -0.3045, -0.5745],
        [ 1.0869,  1.0671,  1.0290,  1.0450,  1.0823,  0.9889],
        [ 1.5829,  1.5810,  1.5036,  1.5419,  1.5832,  1.5456],
        [ 0.9611,  1.0342,  0.9709,  1.0417,  1.0111,  1.0087],
        [ 0.7896,  0.7644,  0.7910,  0.7959,  0.7980,  0.7601]],
       device='cuda:0', grad_fn=<AddmmBackward0>)
net(states_v).shape
torch.Size([32, 6])
net(states_v).gather(1, actions_v.unsqueeze(-1)))
Traceback (most recent call last):
  File "C:\Users\fwisn\PycharmProjects\openaigym-playground\r06\02_dqn_pong.py", line 119, in calc_loss
    state_action_values = net(states_v).gather(1, actions_v.unsqueeze(-1)).squeeze(-1)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: gather(): Expected dtype int64 for index

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\fwisn\PycharmProjects\openaigym-playground\r06\02_dqn_pong.py", line 203, in <module>
    loss_t = calc_loss(batch, net, tgt_net, device=device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\fwisn\PycharmProjects\openaigym-playground\r06\02_dqn_pong.py", line 135, in calc_loss
    print(net(states_v).gather(1, actions_v.unsqueeze(-1)))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: gather(): Expected dtype int64 for index

Process finished with exit code 1



837303: gry - 452, nagroda 18.760, eps 0.01, 140.64 fps
Nagroda uleg�a zmianie: 18.750 -> 18.760
839259: gry - 453, nagroda 18.810, eps 0.01, 139.43 fps
Nagroda uleg�a zmianie: 18.760 -> 18.810
840913: gry - 454, nagroda 18.910, eps 0.01, 150.88 fps
Nagroda uleg�a zmianie: 18.810 -> 18.910
842692: gry - 455, nagroda 18.910, eps 0.01, 157.51 fps
844728: gry - 456, nagroda 18.900, eps 0.01, 155.64 fps
846381: gry - 457, nagroda 18.920, eps 0.01, 142.70 fps
Nagroda uleg�a zmianie: 18.910 -> 18.920
848324: gry - 458, nagroda 19.050, eps 0.01, 143.68 fps
Nagroda uleg�a zmianie: 18.920 -> 19.050
Rozwi�zano po 848324 klatkach!

Process finished with exit code 0
